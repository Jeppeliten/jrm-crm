/* Accessibility Styles - WCAG 2.1 AA compliant styles for Swedish users
   Tillgänglighetsstilar enligt svenska riktlinjer och WCAG 2.1 AA */

/* ==========================================================================
   SCREEN READER UTILITIES - Skärmläsarverktyg
   ========================================================================== */

/* Dölj visuellt men tillgängligt för skärmläsare */
.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/* Visa endast för skärmläsare vid fokus */
.sr-only-focusable:active,
.sr-only-focusable:focus {
  position: static !important;
  width: auto !important;
  height: auto !important;
  padding: inherit !important;
  margin: inherit !important;
  overflow: visible !important;
  clip: auto !important;
  white-space: normal !important;
}

/* ==========================================================================
   FOCUS MANAGEMENT - Fokushantering enligt svenska standarder
   ========================================================================== */

/* Förbättrade fokusindikatorer för svenska användare */
*:focus-visible {
  outline: 3px solid var(--color-focus, #005aa0) !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 5px rgba(0, 90, 160, 0.25) !important;
}

/* Kritiska element får extra tydlig fokus */
.btn-primary:focus-visible,
.btn-danger:focus-visible,
[data-critical="true"]:focus-visible,
[role="button"][data-critical="true"]:focus-visible {
  outline: 4px solid #ffff00 !important;
  outline-offset: 2px !important;
  box-shadow: 
    0 0 0 6px rgba(255, 255, 0, 0.3),
    0 0 0 8px rgba(0, 90, 160, 0.2) !important;
}

/* Dölj standardfokus när vi använder :focus-visible */
*:focus:not(:focus-visible) {
  outline: none;
}

/* Fokusring för interaktiva element */
button:focus-visible,
[role="button"]:focus-visible,
a:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible,
[tabindex]:focus-visible {
  outline: 3px solid var(--color-focus, #005aa0) !important;
  outline-offset: 2px !important;
  transition: outline 0.2s ease !important;
}

/* Specialfokus för formulärelement */
input:focus-visible,
select:focus-visible,
textarea:focus-visible {
  border-color: var(--color-focus, #005aa0) !important;
  box-shadow: 
    0 0 0 3px rgba(0, 90, 160, 0.25),
    inset 0 1px 3px rgba(0, 0, 0, 0.1) !important;
}

/* Keyboard navigation indikator */
.keyboard-navigation *:focus {
  outline: 3px solid var(--color-focus, #005aa0) !important;
  outline-offset: 2px !important;
}

/* ==========================================================================
   HIGH CONTRAST MODE - Högkontrastläge för svenska användare
   ========================================================================== */

.high-contrast {
  /* Bas färgschema för högkontrast */
  --color-text-primary: #000000 !important;
  --color-text-secondary: #000000 !important;
  --color-background-primary: #ffffff !important;
  --color-background-secondary: #f8f9fa !important;
  --color-border-primary: #000000 !important;
  --color-border-secondary: #6c757d !important;
  
  /* Färger för interaktiva element */
  --color-primary: #0000ff !important;
  --color-primary-hover: #000080 !important;
  --color-secondary: #6c757d !important;
  --color-success: #008000 !important;
  --color-warning: #ff8c00 !important;
  --color-danger: #ff0000 !important;
  --color-info: #0000ff !important;
  
  /* Fokusindikator i högkontrast */
  --color-focus: #ffff00 !important;
}

.high-contrast *,
.high-contrast *:before,
.high-contrast *:after {
  /* Tvinga högkontrast på alla element */
  text-shadow: none !important;
  box-shadow: none !important;
  filter: none !important;
}

.high-contrast img,
.high-contrast video,
.high-contrast canvas,
.high-contrast svg {
  /* Öka kontrast för mediaelement */
  filter: contrast(150%) !important;
}

.high-contrast button,
.high-contrast .btn {
  background: #ffffff !important;
  color: #000000 !important;
  border: 2px solid #000000 !important;
}

.high-contrast button:hover,
.high-contrast .btn:hover,
.high-contrast button:focus,
.high-contrast .btn:focus {
  background: #000000 !important;
  color: #ffffff !important;
}

.high-contrast a {
  color: #0000ff !important;
  text-decoration: underline !important;
}

.high-contrast a:visited {
  color: #800080 !important;
}

.high-contrast a:hover,
.high-contrast a:focus {
  background: #ffff00 !important;
  color: #000000 !important;
}

/* ==========================================================================
   REDUCED MOTION - Rörelsereduktion för känsliga användare
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  /* Inaktivera animationer för användare som föredrar mindre rörelse */
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  
  /* Behåll viktiga animationer men minska intensiteten */
  .loading-spinner {
    animation-duration: 0.5s !important;
  }
  
  /* Ta bort parallax-effekter */
  [data-parallax] {
    transform: none !important;
  }
}

/* ==========================================================================
   FORM ACCESSIBILITY - Formulärtillgänglighet
   ========================================================================== */

/* Obligatoriska fält */
.required::after,
[required] + label::after,
label[for] [required]::after {
  content: " *";
  color: var(--color-danger, #dc3545);
  font-weight: bold;
  margin-left: 2px;
}

/* Aria-required indikator */
[aria-required="true"] + label::after,
label[for] [aria-required="true"]::after {
  content: " *";
  color: var(--color-danger, #dc3545);
  font-weight: bold;
  margin-left: 2px;
}

/* Fel-indikatorer */
.is-invalid,
[aria-invalid="true"] {
  border-color: var(--color-danger, #dc3545) !important;
  box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.25) !important;
}

.invalid-feedback,
[role="alert"] {
  display: block;
  width: 100%;
  margin-top: 4px;
  font-size: 0.875rem;
  color: var(--color-danger, #dc3545);
  
  /* Gör felmeddelanden tydliga för skärmläsare */
  font-weight: 600;
}

/* Framgångsindikatorer */
.is-valid {
  border-color: var(--color-success, #28a745) !important;
  box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.25) !important;
}

.valid-feedback {
  display: block;
  width: 100%;
  margin-top: 4px;
  font-size: 0.875rem;
  color: var(--color-success, #28a745);
}

/* Fieldset och legend förbättringar */
fieldset {
  border: 2px solid var(--color-border-primary, #dee2e6);
  border-radius: var(--border-radius-md, 6px);
  padding: var(--spacing-4, 16px);
  margin-bottom: var(--spacing-4, 16px);
}

legend {
  font-weight: 600;
  padding: 0 var(--spacing-2, 8px);
  color: var(--color-text-primary, #212529);
}

/* ==========================================================================
   TABLE ACCESSIBILITY - Tabelltillgänglighet
   ========================================================================== */

/* Förbättrade tabellrubriker */
th {
  background: var(--color-background-secondary, #f8f9fa);
  font-weight: 600;
  text-align: left;
  border-bottom: 2px solid var(--color-border-primary, #dee2e6);
}

/* Tydliga tabellceller */
td {
  border-bottom: 1px solid var(--color-border-secondary, #e9ecef);
  vertical-align: top;
}

/* Sorteringsindikator för rubriker */
th[aria-sort] {
  cursor: pointer;
  position: relative;
  user-select: none;
}

th[aria-sort="ascending"]::after {
  content: " ↑";
  color: var(--color-primary, #007bff);
  font-weight: bold;
}

th[aria-sort="descending"]::after {
  content: " ↓";
  color: var(--color-primary, #007bff);
  font-weight: bold;
}

th[aria-sort="none"]::after {
  content: " ↕";
  color: var(--color-text-secondary, #6c757d);
  opacity: 0.5;
}

/* Tabellfokus för keyboard navigation */
table:focus,
th:focus,
td:focus {
  outline: 2px solid var(--color-focus, #005aa0);
  outline-offset: -2px;
}

/* ==========================================================================
   MODAL ACCESSIBILITY - Modaltillgänglighet
   ========================================================================== */

/* Modal fokusfälla */
.modal {
  /* Säkerställ att modaler är tillgängliga */
  position: fixed;
  top: 0;
  left: 0;
  z-index: 1055;
  width: 100%;
  height: 100%;
  overflow-x: hidden;
  overflow-y: auto;
  outline: 0;
}

.modal-dialog {
  position: relative;
  width: auto;
  margin: var(--spacing-2, 8px);
  pointer-events: none;
}

.modal-content {
  position: relative;
  background: var(--color-background-primary, #ffffff);
  border: 1px solid var(--color-border-primary, #dee2e6);
  border-radius: var(--border-radius-lg, 8px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
  pointer-events: auto;
  outline: 0;
}

/* Modal header med tydlig stängningsknapp */
.modal-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--spacing-4, 16px);
  border-bottom: 1px solid var(--color-border-secondary, #e9ecef);
}

.modal-title {
  margin: 0;
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--color-text-primary, #212529);
}

.btn-close {
  padding: var(--spacing-2, 8px);
  margin: calc(var(--spacing-2, 8px) * -1);
  background: none;
  border: 0;
  font-size: 1.5rem;
  font-weight: 700;
  line-height: 1;
  color: var(--color-text-secondary, #6c757d);
  cursor: pointer;
  
  /* Tillgänglig stängningsknapp */
  min-width: 44px;
  min-height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--border-radius-sm, 4px);
}

.btn-close:hover,
.btn-close:focus {
  background: var(--color-background-secondary, #f8f9fa);
  color: var(--color-text-primary, #212529);
  outline: 2px solid var(--color-focus, #005aa0);
}

/* ==========================================================================
   NAVIGATION ACCESSIBILITY - Navigationstillgänglighet
   ========================================================================== */

/* Huvudnavigation */
nav[role="navigation"],
.navbar {
  /* Tydlig navigationslayout */
  position: relative;
}

/* Navigationslistor */
nav ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

nav li {
  position: relative;
}

/* Navigationslänkar */
nav a {
  display: block;
  padding: var(--spacing-2, 8px) var(--spacing-3, 12px);
  text-decoration: none;
  color: var(--color-text-primary, #212529);
  border-radius: var(--border-radius-sm, 4px);
  transition: all 0.2s ease;
  
  /* Tillräcklig träffyta */
  min-height: 44px;
  display: flex;
  align-items: center;
}

nav a:hover,
nav a:focus {
  background: var(--color-background-secondary, #f8f9fa);
  color: var(--color-primary, #007bff);
  text-decoration: none;
}

nav a[aria-current="page"] {
  background: var(--color-primary, #007bff);
  color: white;
  font-weight: 600;
}

/* Dropdown-menyer */
.dropdown-menu {
  /* Tydliga dropdown-menyer */
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  min-width: 200px;
  padding: var(--spacing-2, 8px) 0;
  margin: 2px 0 0;
  background: var(--color-background-primary, #ffffff);
  border: 1px solid var(--color-border-primary, #dee2e6);
  border-radius: var(--border-radius-md, 6px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.dropdown-menu.show {
  display: block;
}

.dropdown-item {
  display: block;
  width: 100%;
  padding: var(--spacing-2, 8px) var(--spacing-3, 12px);
  clear: both;
  font-weight: 400;
  color: var(--color-text-primary, #212529);
  text-align: inherit;
  text-decoration: none;
  white-space: nowrap;
  background: transparent;
  border: 0;
  min-height: 44px;
  
  transition: all 0.2s ease;
}

.dropdown-item:hover,
.dropdown-item:focus {
  background: var(--color-background-secondary, #f8f9fa);
  color: var(--color-primary, #007bff);
  text-decoration: none;
}

/* Brödsmulor */
.breadcrumb {
  display: flex;
  flex-wrap: wrap;
  padding: var(--spacing-2, 8px) 0;
  margin-bottom: var(--spacing-3, 12px);
  list-style: none;
  background: transparent;
}

.breadcrumb-item + .breadcrumb-item::before {
  content: "/";
  display: inline-block;
  padding: 0 var(--spacing-2, 8px);
  color: var(--color-text-secondary, #6c757d);
}

.breadcrumb-item.active {
  color: var(--color-text-secondary, #6c757d);
  font-weight: 600;
}

/* ==========================================================================
   ERROR AND SUCCESS STATES - Fel- och framgångstillstånd
   ========================================================================== */

/* Varningar och meddelanden */
.alert {
  position: relative;
  padding: var(--spacing-3, 12px) var(--spacing-4, 16px);
  margin-bottom: var(--spacing-3, 12px);
  border: 1px solid transparent;
  border-radius: var(--border-radius-md, 6px);
}

.alert-success {
  color: #155724;
  background-color: #d4edda;
  border-color: #c3e6cb;
}

.alert-info {
  color: #0c5460;
  background-color: #d1ecf1;
  border-color: #bee5eb;
}

.alert-warning {
  color: #856404;
  background-color: #fff3cd;
  border-color: #ffeaa7;
}

.alert-danger {
  color: #721c24;
  background-color: #f8d7da;
  border-color: #f5c6cb;
}

/* Ikoner för olika meddelandetyper */
.alert::before {
  content: "";
  display: inline-block;
  width: 20px;
  height: 20px;
  margin-right: var(--spacing-2, 8px);
  vertical-align: text-top;
  background-size: contain;
  background-repeat: no-repeat;
}

.alert-success::before {
  content: "✓";
  color: #28a745;
  font-weight: bold;
  font-size: 1.2em;
}

.alert-info::before {
  content: "ℹ";
  color: #17a2b8;
  font-weight: bold;
  font-size: 1.2em;
}

.alert-warning::before {
  content: "⚠";
  color: #ffc107;
  font-weight: bold;
  font-size: 1.2em;
}

.alert-danger::before {
  content: "✕";
  color: #dc3545;
  font-weight: bold;
  font-size: 1.2em;
}

/* ==========================================================================
   PRINT ACCESSIBILITY - Utskriftstillgänglighet
   ========================================================================== */

@media print {
  /* Dölj interaktiva element vid utskrift */
  .btn,
  .form-control,
  .dropdown,
  nav,
  .modal,
  .alert-dismissible .btn-close,
  [data-print="hide"] {
    display: none !important;
  }
  
  /* Säkerställ läsbarhet vid utskrift */
  body {
    font-size: 12pt;
    line-height: 1.5;
    color: #000;
    background: #fff;
  }
  
  /* Visa URL för länkar */
  a[href]:after {
    content: " (" attr(href) ")";
    font-size: 10pt;
    color: #666;
  }
  
  /* Förbättra rubrikstruktur för utskrift */
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
    page-break-inside: avoid;
  }
  
  /* Säkerställ tabeller bryts korrekt */
  table {
    page-break-inside: avoid;
  }
  
  th {
    page-break-after: avoid;
  }
}

/* ==========================================================================
   SVENSKA ACCESSIBILITY ENHANCEMENTS - Svenska tillgänglighetsförbättringar
   ========================================================================== */

/* Svenska språkspecifika förbättringar */
:lang(sv) {
  /* Ordbrytning för svenska ord */
  hyphens: auto;
  -webkit-hyphens: auto;
  -ms-hyphens: auto;
  word-break: normal;
  overflow-wrap: break-word;
}

/* Svenska teckenstorlek för bättre läsbarhet */
:lang(sv) p,
:lang(sv) li,
:lang(sv) span {
  font-size: 1rem;
  line-height: 1.6;
}

/* Svenska rubriker */
:lang(sv) h1,
:lang(sv) h2,
:lang(sv) h3,
:lang(sv) h4,
:lang(sv) h5,
:lang(sv) h6 {
  line-height: 1.3;
  margin-bottom: 0.5em;
}

/* Svenska formulärtexter */
:lang(sv) label {
  font-weight: 600;
  margin-bottom: var(--spacing-1, 4px);
  display: block;
  color: var(--color-text-primary, #212529);
}

/* Svenska hjälptexter */
.form-text:lang(sv),
.help-text:lang(sv) {
  font-size: 0.875rem;
  color: var(--color-text-secondary, #6c757d);
  margin-top: var(--spacing-1, 4px);
  line-height: 1.4;
}